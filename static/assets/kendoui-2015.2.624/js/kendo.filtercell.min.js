/*
* Kendo UI v2015.2.624 (http://www.telerik.com/kendo-ui)
* Copyright 2015 Telerik AD. All rights reserved.
*
* Kendo UI commercial licenses may be obtained at
* http://www.telerik.com/purchase/license-agreement/kendo-ui-complete
* If you do not own a commercial license, this file shall be governed by the trial license terms.
* 若您需要使用Kendo UI Professional，请联系版权人获得合法的授权或许可。
*/
!function(e,define){define(["./kendo.autocomplete.min","./kendo.datepicker.min","./kendo.numerictextbox.min","./kendo.combobox.min","./kendo.dropdownlist.min"],e)}(function(){return function(e,t){function n(t,i){var o,r,s=[];if(e.isPlainObject(t))if(t.hasOwnProperty("filters"))s=t.filters;else if(t.field==i)return t;for(e.isArray(t)&&(s=t),o=0;s.length>o;o++)if(r=n(s[o],i))return r}function i(t,n){t.filters&&(t.filters=e.grep(t.filters,function(e){return i(e,n),e.filters?e.filters.length:e.field!=n}))}function o(e,t){var n=r.getter(t,!0);return function(t){for(var i,o,r=e(t),s=[],a=0,l={};r.length>a;)i=r[a++],o=n(i),l.hasOwnProperty(o)||(s.push(i),l[o]=!0);return s}}var r=window.kendo,s=r.ui,a=r.data.DataSource,l=s.Widget,c="change",h="boolean",d="enums",u="string",f="Is equal to",p="Is not equal to",g=e.proxy,m=l.extend({init:function(n,i){var o,s,a,f,p,m,v,_,y,w,b,x;if(n=e(n).addClass("k-filtercell"),o=this.wrapper=e("<span/>").appendTo(n),s=this,p=i,_=s.operators=i.operators||{},y=s.input=e("<input/>").attr(r.attr("bind"),"value: value").appendTo(o),l.fn.init.call(s,n[0],i),i=s.options,a=s.dataSource=i.dataSource,s.model=a.reader.model,v=i.type=u,w=r.getter("reader.model.fields",!0)(a)||{},b=w[i.field],b&&b.type&&(v=i.type=b.type),i.values&&(i.type=v=d),_=_[v]||i.operators[v],!p.operator)for(m in _){i.operator=m;break}s._parse=function(e){return e+""},s.model&&s.model.fields&&(x=s.model.fields[i.field],x&&x.parse&&(s._parse=g(x.parse,x))),s.viewModel=f=r.observable({operator:i.operator,value:null,operatorVisible:function(){var e=this.get("value");return null!==e&&e!==t&&"undefined"!=e}}),f.bind(c,g(s.updateDsFilter,s)),v==u&&s.initSuggestDataSource(i),null!==i.inputWidth&&y.width(i.inputWidth),s._setInputType(i,v),v!=h&&i.showOperators!==!1?s._createOperatorDropDown(_):o.addClass("k-operator-hidden"),s._createClearIcon(),r.bind(this.wrapper,f),v==u&&(i.template||s.setAutoCompleteSource()),v==d&&s.setComboBoxSource(s.options.values),s._refreshUI(),s._refreshHandler=g(s._refreshUI,s),s.dataSource.bind(c,s._refreshHandler)},_setInputType:function(t,n){var i,o,s,a,l,c=this,f=c.input;"function"==typeof t.template?t.template.call(c.viewModel,{element:c.input,dataSource:c.suggestDataSource}):n==u?f.attr(r.attr("role"),"autocomplete").attr(r.attr("text-field"),t.dataTextField||t.field).attr(r.attr("filter"),t.suggestionOperator).attr(r.attr("delay"),t.delay).attr(r.attr("min-length"),t.minLength).attr(r.attr("value-primitive"),!0):"date"==n?f.attr(r.attr("role"),"datepicker"):n==h?(f.remove(),i=e("<input type='radio'/>"),o=c.wrapper,s=r.guid(),a=e("<label/>").text(t.messages.isTrue).append(i),i.attr(r.attr("bind"),"checked:value").attr("name",s).val("true"),l=a.clone().text(t.messages.isFalse),i.clone().val("false").appendTo(l),o.append([a,l])):"number"==n?f.attr(r.attr("role"),"numerictextbox"):n==d&&f.attr(r.attr("role"),"combobox").attr(r.attr("text-field"),"text").attr(r.attr("suggest"),!0).attr(r.attr("filter"),"contains").attr(r.attr("value-field"),"value").attr(r.attr("value-primitive"),!0)},_createOperatorDropDown:function(t){var n,i,o=[];for(n in t)o.push({text:t[n],value:n});i=e('<input class="k-dropdown-operator" '+r.attr("bind")+'="value: operator"/>').appendTo(this.wrapper),this.operatorDropDown=i.kendoDropDownList({dataSource:o,dataTextField:"text",dataValueField:"value",open:function(){this.popup.element.width(150)},valuePrimitive:!0}).data("kendoDropDownList"),this.operatorDropDown.wrapper.find(".k-i-arrow-s").removeClass("k-i-arrow-s").addClass("k-filter")},initSuggestDataSource:function(e){var n=e.suggestDataSource;n instanceof a||(!e.customDataSource&&n&&(n.group=t),n=this.suggestDataSource=a.create(n)),e.customDataSource||(n._pageSize=t,n.reader.data=o(n.reader.data,this.options.field)),this.suggestDataSource=n},setAutoCompleteSource:function(){var e=this.input.data("kendoAutoComplete");e&&e.setDataSource(this.suggestDataSource)},setComboBoxSource:function(e){var t=a.create({data:e}),n=this.input.data("kendoComboBox");n&&n.setDataSource(t)},_refreshUI:function(){var t=this,i=n(t.dataSource.filter(),this.options.field)||{},o=t.viewModel;t.manuallyUpdatingVM=!0,i=e.extend(!0,{},i),t.options.type==h&&o.value!==i.value&&t.wrapper.find(":radio").prop("checked",!1),i.operator&&o.set("operator",i.operator),o.set("value",i.value),t.manuallyUpdatingVM=!1},updateDsFilter:function(n){var i,o,r,s=this,a=s.viewModel;s.manuallyUpdatingVM||"operator"==n.field&&a.value===t||(i=e.extend({},s.viewModel.toJSON(),{field:s.options.field}),o={logic:"and",filters:[]},i.value!==t&&null!==i.value&&o.filters.push(i),r=s._merge(o),s.dataSource.filter(r.filters.length?r:{}))},_merge:function(t){var n,o,r,s=this,a=t.logic||"and",l=t.filters,c=s.dataSource.filter()||{filters:[],logic:"and"};for(i(c,s.options.field),o=0,r=l.length;r>o;o++)n=l[o],n.value=s._parse(n.value);return l=e.grep(l,function(e){return""!==e.value&&null!==e.value}),l.length&&(c.filters.length?(t.filters=l,"and"!==c.logic&&(c.filters=[{logic:c.logic,filters:c.filters}],c.logic="and"),c.filters.push(l.length>1?t:l[0])):(c.filters=l,c.logic=a)),c},_createClearIcon:function(){var t=this;e("<button type='button' class='k-button k-button-icon'/>").attr(r.attr("bind"),"visible:operatorVisible").html("<span class='k-icon k-i-close'/>").click(g(t.clearFilter,t)).appendTo(t.wrapper)},clearFilter:function(){this.viewModel.set("value",null)},destroy:function(){var e=this;e.filterModel=null,l.fn.destroy.call(e),r.destroy(e.element)},events:[c],options:{name:"FilterCell",delay:200,minLength:1,inputWidth:null,values:t,customDataSource:!1,field:"",dataTextField:"",type:"string",suggestDataSource:null,suggestionOperator:"startswith",operator:"eq",showOperators:!0,template:null,messages:{isTrue:"is true",isFalse:"is false",filter:"Filter",clear:"Clear",operator:"Operator"},operators:{string:{eq:f,neq:p,startswith:"Starts with",contains:"Contains",doesnotcontain:"Does not contain",endswith:"Ends with"},number:{eq:f,neq:p,gte:"Is greater than or equal to",gt:"Is greater than",lte:"Is less than or equal to",lt:"Is less than"},date:{eq:f,neq:p,gte:"Is after or equal to",gt:"Is after",lte:"Is before or equal to",lt:"Is before"},enums:{eq:f,neq:p}}}});s.plugin(m)}(window.kendo.jQuery),window.kendo},"function"==typeof define&&define.amd?define:function(e,t){t()});